<% content_for :page_title, "Modifier la configuration" %>

<div class="mb-8">
  <div class="flex items-center space-x-4 mb-4">
    <%= link_to admin_app_config_path, class: "text-gray-600 hover:text-blue-hero" do %>
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
    <% end %>
    <h1 class="text-4xl md:text-5xl font-bold text-gray-900">
      Modifier la <span class="text-blue-hero">Configuration</span>
    </h1>
  </div>
  <p class="text-xl text-gray-600">
    Mettez √† jour les informations de contact et les textes l√©gaux
  </p>
</div>

<%= form_with model: [:admin, @app_config], url: admin_app_config_path, method: :patch, data: { turbo: false }, local: true, class: "space-y-8" do |f| %>
  <!-- Contact Information -->
  <div class="bg-white rounded-super shadow-sm p-6 md:p-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-6">Informations de contact</h2>
    
    <div class="space-y-6">
      <div>
        <%= f.label :contact_email, "Email de contact", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= f.email_field :contact_email, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-hero focus:border-transparent", placeholder: "contact@supercaralive.fr" %>
        <p class="text-sm text-gray-500 mt-1">Cet email sera utilis√© pour les liens "Contacter le support" sur le site.</p>
      </div>
      
      <div>
        <%= f.label :contact_phone, "T√©l√©phone de contact", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= f.text_field :contact_phone, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-hero focus:border-transparent", placeholder: "+33 1 23 45 67 89" %>
        <p class="text-sm text-gray-500 mt-1">Ce num√©ro sera affich√© avec une ic√¥ne t√©l√©phone sur les pages de contact.</p>
      </div>
      
      <div>
        <%= f.label :address, "Adresse", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= f.text_area :address, rows: 3, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-hero focus:border-transparent", placeholder: "123 Avenue de l'Automobile\n75000 Paris, France" %>
        <p class="text-sm text-gray-500 mt-1">Adresse compl√®te de l'entreprise.</p>
      </div>
      
      <div>
        <%= f.label :opening_hours, "Horaires", class: "block text-sm font-medium text-gray-700 mb-2" %>
        <%= f.text_area :opening_hours, rows: 4, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-hero focus:border-transparent", placeholder: "Lundi - Vendredi : 9h00 - 18h00\nSamedi : 10h00 - 16h00\nDimanche : Ferm√©" %>
        <p class="text-sm text-gray-500 mt-1">Horaires d'ouverture de l'entreprise.</p>
      </div>
    </div>
  </div>

  <!-- Legal Documents -->
  <div class="space-y-8">
    <!-- Terms of Service -->
    <div class="bg-white rounded-super shadow-sm p-6 md:p-8" data-controller="markdown-editor">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold text-gray-900">Conditions G√©n√©rales d'Utilisation</h2>
        <button type="button" 
                data-action="click->markdown-editor#togglePreview"
                class="text-sm text-blue-hero hover:text-blue-dark font-medium">
          Aper√ßu
        </button>
      </div>
      <%= f.label :terms_of_service, "Contenu des CGU", class: "block text-sm font-medium text-gray-700 mb-2" %>
      
      <!-- Toolbar -->
      <div class="flex flex-wrap gap-2 mb-2 p-2 bg-gray-50 rounded-t-lg border border-gray-300 border-b-0" data-markdown-editor-target="toolbar">
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="h1"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Titre 1">
          <strong>H1</strong>
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="h2"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Titre 2">
          <strong>H2</strong>
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="h3"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Titre 3">
          <strong>H3</strong>
        </button>
        <div class="w-px bg-gray-300 mx-1"></div>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="bold"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100 font-bold"
                title="Gras">
          <strong>B</strong>
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="italic"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100 italic"
                title="Italique">
          <em>I</em>
        </button>
        <div class="w-px bg-gray-300 mx-1"></div>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="ul"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Liste √† puces">
          ‚Ä¢ Liste
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="ol"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Liste num√©rot√©e">
          1. Liste
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="link"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Lien">
          üîó Lien
        </button>
      </div>
      
      <!-- Editor -->
      <div class="markdown-editor-container">
        <%= f.text_area :terms_of_service, 
                        rows: 20, 
                        data: { markdown_editor_target: "textarea" },
                        class: "w-full px-4 py-3 border border-gray-300 rounded-b-lg focus:outline-none focus:ring-2 focus:ring-blue-hero focus:border-transparent font-mono text-sm", 
                        placeholder: "Saisissez le contenu des Conditions G√©n√©rales d'Utilisation en Markdown...\n\nExemples :\n# Titre principal\n## Sous-titre\n**Texte en gras**\n*Texte en italique*\n- Liste √† puces\n1. Liste num√©rot√©e" %>
      </div>
      
      <!-- Preview -->
      <div class="markdown-preview-container hidden border border-gray-300 rounded-b-lg bg-white">
        <div data-markdown-editor-target="preview" 
             class="px-4 py-3 prose prose-sm max-w-none min-h-[500px] markdown-content">
        </div>
      </div>
      
      <p class="text-sm text-gray-500 mt-1">Ce contenu remplacera le texte par d√©faut sur la page CGU. Utilisez la syntaxe Markdown pour la mise en forme.</p>
    </div>
    
    <!-- Privacy Policy -->
    <div class="bg-white rounded-super shadow-sm p-6 md:p-8" data-controller="markdown-editor">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold text-gray-900">Politique de Confidentialit√©</h2>
        <button type="button" 
                data-action="click->markdown-editor#togglePreview"
                class="text-sm text-blue-hero hover:text-blue-dark font-medium">
          Aper√ßu
        </button>
      </div>
      <%= f.label :privacy_policy, "Contenu de la politique", class: "block text-sm font-medium text-gray-700 mb-2" %>
      
      <!-- Toolbar -->
      <div class="flex flex-wrap gap-2 mb-2 p-2 bg-gray-50 rounded-t-lg border border-gray-300 border-b-0" data-markdown-editor-target="toolbar">
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="h1"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Titre 1">
          <strong>H1</strong>
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="h2"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Titre 2">
          <strong>H2</strong>
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="h3"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Titre 3">
          <strong>H3</strong>
        </button>
        <div class="w-px bg-gray-300 mx-1"></div>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="bold"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100 font-bold"
                title="Gras">
          <strong>B</strong>
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="italic"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100 italic"
                title="Italique">
          <em>I</em>
        </button>
        <div class="w-px bg-gray-300 mx-1"></div>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="ul"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Liste √† puces">
          ‚Ä¢ Liste
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="ol"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Liste num√©rot√©e">
          1. Liste
        </button>
        <button type="button" 
                data-action="click->markdown-editor#insertMarkdown"
                data-action-value="link"
                class="px-3 py-1 text-sm bg-white border border-gray-300 rounded hover:bg-gray-100"
                title="Lien">
          üîó Lien
        </button>
      </div>
      
      <!-- Editor -->
      <div class="markdown-editor-container">
        <%= f.text_area :privacy_policy, 
                        rows: 20, 
                        data: { markdown_editor_target: "textarea" },
                        class: "w-full px-4 py-3 border border-gray-300 rounded-b-lg focus:outline-none focus:ring-2 focus:ring-blue-hero focus:border-transparent font-mono text-sm", 
                        placeholder: "Saisissez le contenu de la Politique de Confidentialit√© en Markdown...\n\nExemples :\n# Titre principal\n## Sous-titre\n**Texte en gras**\n*Texte en italique*\n- Liste √† puces\n1. Liste num√©rot√©e" %>
      </div>
      
      <!-- Preview -->
      <div class="markdown-preview-container hidden border border-gray-300 rounded-b-lg bg-white">
        <div data-markdown-editor-target="preview" 
             class="px-4 py-3 prose prose-sm max-w-none min-h-[500px] markdown-content">
        </div>
      </div>
      
      <p class="text-sm text-gray-500 mt-1">Ce contenu remplacera le texte par d√©faut sur la page de confidentialit√©. Utilisez la syntaxe Markdown pour la mise en forme.</p>
    </div>
  </div>

  <!-- Actions -->
  <div class="flex flex-col sm:flex-row gap-4 justify-end">
    <%= link_to "Annuler", admin_app_config_path, class: "bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-medium inline-flex items-center justify-center" %>
    <%= f.submit "Enregistrer les modifications", class: "bg-blue-hero hover:bg-blue-dark text-white px-6 py-3 rounded-lg font-bold inline-flex items-center justify-center" %>
  </div>
<% end %>

